<!DOCTYPE html>
<meta charset="utf-8">
<style>
.links {
  stroke: #000;
  stroke-opacity: 0.2;
}
.polygons {
  /* fill: #005b; */
  stroke: #1a5b;
  stroke-width: 2;
}
.polygons :first-child {
  fill: rgb(19, 4, 104);
}
.sites {
  fill: #000;
  stroke: #fff;
}
.sites :first-child {
  /* fill: #fff; */
}
</style>
<!-- <image width="300" height="300" src="royLicht.jpg"> </image> -->

<svg width="777" height="999">
<defs>
        <!-- <pattern id="img1" patternUnits="objectBoundingBox" width="300" height="600"> -->
        <pattern id="img1" patternUnits="userSpaceOnUse" width="1111" height="999">
            <image xlink:href="ignore/roy_resize.jpg" x="-222" y="0" width="1111" height="999" />
        </pattern>
</defs>
</svg>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

var image = new Image;
image.src = "roy_resize.jpg";
image.onload = roydraw;
const NUM_OF_SITES = 16; 

var svg = d3.select("svg")
        // .on("touchmove mousemove", logposition)
        // .on("touchmove mousemove", moved)
        ,
    width = +svg.attr("width"),
    height = +svg.attr("height");

function logposition() {
    console.log(d3.mouse(this));
}

var sites = d3.range(NUM_OF_SITES)
    .map(function(d) { return [Math.random() * width, Math.random() * height]; });

var voronoi = d3.voronoi()
    .extent([[-1, -1], [width + 1, height + 1]]);

var polygon = svg.append("g")
    .attr("class", "polygons")
    .selectAll("path")
    .data(voronoi.polygons(sites))
    .enter().append("path")
    .attr("fill", "url(#img1)")
  // draws polygon set for the first time
    .call(redrawPolygon);


function redrawPolygon(polygon) {
  polygon
      .attr("d", function(d) { 
        //   console.log(d);
          return d ? "M" + d.join("L") + "Z" : null; 
        });
    //   .attr("fill", "url(#img1)");
}

function roydraw() {
    var deep = d3.selectAll("path");
    for (var site in sites) {
        x = Math.round(sites[site][0]);
        y = Math.round(sites[site][1]);
        console.log(x,y);
    }
    // console.log(sites);
    // console.log(deep);
    // for (var prop1 in deep) {
    //     if (prop1 == "_groups") {
    //         for (var prop2 in deep[prop1]) {
    //             for (var prop3 in deep[prop1][prop2]) {
    //                 console.log(typeof deep[prop1][prop2][prop3]);
    //             }
    //         }
    //     }
    // }
}

</script>